{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://unigateway.io/configuration/schema#",
  "title": "UniGateway 1.0 Configuration file",
  "description": "JSON schema for UniGateway Configuration file",
  "type": "object",
  "required": [
    "configVersion",
    "id",
    "name",
    "devices"
  ],
  "properties": {
    "configVersion": {
      "description": "Version of UniGateway configuration file",
      "type": "string",
      "pattern": "^1\\.0$"
    },
    "id": {
      "description": "Identifier of Gateway",
      "type": "string"
    },
    "name": {
      "description": "Unique name of Gateway",
      "type": "string"
    },
    "devices": {
      "description": "List of device configurations",
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/device"
      }
    }
  },
  "definitions": {
    "device": {
      "type": "object",
      "oneOf": [
        {
          "required": [
            "id",
            "name",
            "type",
            "connectors"
          ]
        },
        {
          "required": [
            "id",
            "name",
            "type",
            "internalDevices"
          ]
        }
      ],
      "properties": {
        "id": {
          "description": "Unique identifier for the device across all devices on this Gateway",
          "$ref": "#/definitions/deviceId"
        },
        "name": {
          "$ref": "#/definitions/deviceName"
        },
        "type": {
          "$ref": "#/definitions/deviceType"
        },
        "connectors": {
          "description": "Connectors configuration for specific device",
          "type": "object",
          "minProperties": 1,
          "patternProperties": {
            "^[^\\s]*$": {
              "$ref": "#/definitions/connector"
            }
          }
        },
        "internalDevices": {
          "type": "object",
          "minProperties": 1,
          "properties": {
            "referenceId": {
              "$ref": "#/definitions/deviceId"
            }
          }
        }
      }
    },
    "deviceId": {
      "type": "string",
      "pattern": "^[^\\s]*$",
      "maxLength": 32
    },
    "deviceName": {
      "description": "Name of the device",
      "type": "string",
      "maxLength": 64
    },
    "deviceType": {
      "description": "Type of device",
      "enum": [
        "RELAY",
        "SWITCH_BUTTON",
        "REED_SWITCH",
        "MOTION_DETECTOR",
        "EMULATED_SWITCH",
        "TIMER_SWITCH",
        "SHUTTER",
        "GATE"
      ]
    },
    "connector": {
      "type": "object",
      "properties": {
        "source": {
          "description": "Connector source",
          "enum": [
            "HARDWARE",
            "MYSENSORS"
          ]
        }
      }
    }
  }
}
